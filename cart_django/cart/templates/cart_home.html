{% extends 'main.html' %}

{% load static %}

{% block head_link %}
<link rel="stylesheet" href="{% static 'css/cart.css' %}">
<link rel="stylesheet" href="{% static 'css/product_detail.css' %}">
{% endblock head_link %}

{% block content %}

{% if message %}
<div class="alert alert-warning" role="alert">
    {{message}}
</div>
{% endif %}
<div class="container py-5">
    <h2 class='text-center'>History cart</h2>
</div>
<div class="container">
    <form method='POST' action="{% url 'order_view' %}">
    {% csrf_token %}
    <table class="table table-striped table-bordered">
        <thead class="text-center">
          <tr class="bg-info">
            <th width="8%">#</th>
            <th width="20%">Name</th>
            <th width="30%">Image</th>
            <th width="12%">Number</th>
            <th width="10%">Price</th>
            <th width="10%">Select</th>
            <th width="10%">Action</th>
          </tr>
        </thead>
        <tbody class="text-center">
        {% comment %} {% if request.user.is_authenticated %} {% endcomment %}
        {% if products %}
        {% for product in products %}
        <tr>
            <td>
                {{product.id}}
            </td>
            <td>
                {{product.product_id.name}}
            </td>
            <td>
                <img class="mg-thumbnail cart_img" src="/media/{{product.product_id.image}}" alt="">
            </td>
            <td>
                {{product.number}}
                {% comment %} <input readonly type="text" name='number{{product.id}}' value='{{product.number}}' style="width: 100%;"> {% endcomment %}
                {% comment %} <div class="d-flex py-2">
                    <button class="left_button btn btn-light number" value="{{product.product_id.number}}">
                        <i class="fa-solid fa-minus"></i>
                    </button>
                    <input type="text" class="quantity input_num mx-2" name='number{{product.id}}' value="{{product.number}}">
                    <button class="right_button btn btn-light">
                        <i class="fa-solid fa-plus"></i>
                    </button>
                </div> {% endcomment %}
            </td>
            <td>
                {{product.product_id.price}}
            </td>
            <td>
                <input class="text-center icon_size" type="checkbox" name="select_product" value="{{product.id}}" style="width: 25px; height: 25px;">
                
            </td>
            <td>
                {% comment %} <a href="{% url 'cart_edit' id=product.id %}"> {% endcomment %}
                {% comment %} <a href="{% url 'cart_edit' id=product.id %}"> {% endcomment %}
                {% if request.user.is_authenticated %}
                <a href="{% url 'cart_edit' id=product.id number=product.number %} ">
                    <i class="fa-solid fa-pen-to-square pe-2"></i>
                </a>
                {% endif %}
                <a href="{% url 'cart_delete' id=product.id %}">
                    <i class="fa-solid fa-trash"></i>
                </a>
            </td>
        </tr>
        {% endfor %}
        {% else %}
        <tr>
            <td class="text-center" colspan="7">No entry!</td>
        </tr>
        {% endif %}
        </tbody>
    </table>
    <div class="d-flex py-2">
        <h5 class="pe-3" style="margin: auto 0">Buy selected products</h5>
        <button class="btn btn-primary" type="submit">
            Buy 
            <i class="fa-solid fa-cart-shopping"></i>
        </button>
    </div>
    </form>
</div>
{% endblock content %}
{% block footer %}
{% include 'footer.html' %}
{% endblock footer %}
{% block js_link %}
    {% load static %}
    <script src="{% static 'js/buta_control.js' %}"></script>
{% endblock js_link %}
